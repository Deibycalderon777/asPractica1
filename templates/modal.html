{% if postresIngredientes %}
    {% if postresIngredientes|length > 0 %}
        <div class="mb-3">
            <h6 class="text-muted">
                <i class="bi bi-cake2"></i> 
                <strong>{{ postresIngredientes[0].nombrePostre }}</strong>
            </h6>
        </div>
    {% endif %}
    
    <div class="table-responsive">
        <table class="table table-sm table-hover">
            <thead class="table-active">
                <tr>
                    <th><i class="bi bi-egg"></i> Ingrediente</th>
                    <th><i class="bi bi-123"></i> Cantidad Requerida</th>
                    <th><i class="bi bi-box-seam"></i> Existencias</th>
                    <th><i class="bi bi-check-circle"></i> Estado</th>
                </tr>
            </thead>
            <tbody>
                {% for postreIngrediente in postresIngredientes %}
                <tr>
                    <td>
                        <strong>{{ postreIngrediente.nombreIngrediente }}</strong>
                    </td>
                    <td>
                        <span class="badge bg-primary">
                            {{ postreIngrediente.cantidad }}
                        </span>
                    </td>
                    <td>
                        <span class="badge bg-info">
                            {{ postreIngrediente.existencias }}
                        </span>
                    </td>
                    <td>
                        {% if postreIngrediente.existencias >= postreIngrediente.cantidad %}
                            <span class="badge bg-success">
                                <i class="bi bi-check-lg"></i> Disponible
                            </span>
                        {% else %}
                            <span class="badge bg-danger">
                                <i class="bi bi-x-lg"></i> Insuficiente
                            </span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div class="mt-3 p-3 bg-light rounded">
        <div class="row">
            <div class="col-md-6">
                <small class="text-muted">
                    <i class="bi bi-info-circle"></i> 
                    <strong>Total de ingredientes:</strong> {{ postresIngredientes|length }}
                </small>
            </div>
            <div class="col-md-6 text-end">
                {% set disponibles = postresIngredientes | selectattr('existencias', 'ge', 'cantidad') | list | length %}
                {% set total = postresIngredientes | length %}
                {% if disponibles == total %}
                    <small class="text-success">
                        <i class="bi bi-check-circle-fill"></i> 
                        <strong>Postre puede prepararse</strong>
                    </small>
                {% else %}
                    <small class="text-warning">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                        <strong>{{ total - disponibles }} ingrediente(s) insuficiente(s)</strong>
                    </small>
                {% endif %}
            </div>
        </div>
    </div>
{% else %}
    <div class="text-center p-4">
        <i class="bi bi-exclamation-circle text-muted" style="font-size: 3rem;"></i>
        <h5 class="text-muted mt-2">No hay ingredientes registrados</h5>
        <p class="text-muted">Este postre no tiene ingredientes asociados.</p>
    </div>
{% endif %}
